<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home ¬∑ ChebyshevExpansions.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://fernandopenaranda.github.io/ChebyshevExpansions.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><script src="../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>ChebyshevExpansions.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/fernandopenaranda/ChebyshevExpansions.jl/blob/master/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab">ÔÇõ</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ChebyshevExpansions"><a class="docs-heading-anchor" href="#ChebyshevExpansions">ChebyshevExpansions</a><a id="ChebyshevExpansions-1"></a><a class="docs-heading-anchor-permalink" href="#ChebyshevExpansions" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/fernandopenaranda/ChebyshevExpansions.jl">ChebyshevExpansions</a>.</p><ul><li><a href="#ChebyshevExpansions.ChebyshevExpansions"><code>ChebyshevExpansions.ChebyshevExpansions</code></a></li><li><a href="#ChebyshevExpansions.averageKPM-Tuple{Any, Any}"><code>ChebyshevExpansions.averageKPM</code></a></li><li><a href="#ChebyshevExpansions.densityKPM-Tuple{Any, Any}"><code>ChebyshevExpansions.densityKPM</code></a></li><li><a href="#ChebyshevExpansions.dosKPM-Tuple{Any}"><code>ChebyshevExpansions.dosKPM</code></a></li><li><a href="#ChebyshevExpansions.momentaKPM"><code>ChebyshevExpansions.momentaKPM</code></a></li><li><a href="#ChebyshevExpansions.randomkets-Tuple{Any, Any, Any}"><code>ChebyshevExpansions.randomkets</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="ChebyshevExpansions.ChebyshevExpansions" href="#ChebyshevExpansions.ChebyshevExpansions"><code>ChebyshevExpansions.ChebyshevExpansions</code></a> ‚Äî <span class="docstring-category">Module</span></header><section><div><p><strong>ChebyshevExpansions</strong></p><p><a href="https://fernandopenaranda.github.io/ChebyshevExpansions.jl/stable"><img src="https://img.shields.io/badge/docs-stable-blue.svg" alt="Stable"/></a> <a href="https://fernandopenaranda.github.io/ChebyshevExpansions.jl/dev"><img src="https://img.shields.io/badge/docs-dev-blue.svg" alt="Dev"/></a> <a href="https://github.com/fernandopenaranda/ChebyshevExpansions.jl/actions/workflows/CI.yml?query=branch%3Amain"><img src="https://github.com/fernandopenaranda/ChebyshevExpansions.jl/actions/workflows/CI.yml/badge.svg?branch=main" alt="Build Status"/></a> <a href="https://codecov.io/gh/fernandopenaranda/ChebyshevExpansions.jl"><img src="https://codecov.io/gh/fernandopenaranda/ChebyshevExpansions.jl/branch/main/graph/badge.svg" alt="Coverage"/></a></p><p><strong>ChebyExpansions.jl</strong></p><p><strong>Introduction</strong></p><p>In this package, we implement the Kernel Polynomial Method (KPM) in Julia, an efficient technique to compute spectral and correlation functions using order-N Chebyshev expansions of said quantities. </p><p>Diagonalization in KPM is replaced by matrix multiplications and, thus, the resource consumption for a given precission drops to <span>$\mathcal{O}(D)$</span> for sparse or <span>$\mathcal{O}(D^2)$</span> for dense matrices, being <span>$D$</span> the matrix dimension. </p><p>In this regard, this technique is well suited for <strong>large matrix calculations</strong> where exact diagonalization becomes too expensive. In addition, KPM offers some advantages in terms of stability and resource consumption with respect to other recursive methods such as Lanczos-based techniques, see [1] for a comprehensive review. </p><p><strong>Practical considerations</strong></p><ol><li>The energy resolution is controlled by the ratio <span>$W/N$</span>, where <span>$W$</span> is the bandwidth of <span>$H$</span> and <span>$N$</span> the expansion order. The complexity for sparse matrices goes like <span>$\mathcal O(ND)$</span></li><li>The error in the stochastic trace estimation <span>$\mathcal{O}(1/\sqrt{DR})$</span>, being R the number of random kets considered.</li></ol><p><strong>Observables</strong></p><p>Currently, given a hamiltonian matrix, <span>$H$</span> and a generic operator <span>$A$</span> the following methods are implemented:</p><ul><li>Momenta computation corresponding to traces over the product of Chebyshev polynomials of <span>$H$</span> and <span>$A$</span>: <span>$\mu_n = \text{Tr}[A T_n(H)]$</span>.</li><li>Calculation of spectral densities of an operator <span>$A(E) = \text{Tr} [A ùõø(E-H)]$</span>.</li><li>Calculation of thermal averages, i.e. <span>$\langle A\rangle _{E_F} = \text{Tr} [A f(H,E_F)]$</span></li></ul><p><strong>Exported functions</strong></p><p><code>momentaKPM</code> <code>dosKPM</code> computes the density of states <span>$(A == I)$</span> <code>densityKPM</code>  <code>averageKPM</code> </p><p><strong>References</strong></p><p>[1] A. Wei√üe, G. Wellein, A. Alvermann, and H. Fehske, <em>The kernel polynomial method</em>, <a href="https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.78.275">Reviews of Modern Physics <strong>78</strong>, 275 (2006)</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fernandopenaranda/ChebyshevExpansions.jl/blob/4645de963f6f0255a8f8eaa44375677da3664687/src/ChebyshevExpansions.jl#L3-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChebyshevExpansions.averageKPM-Tuple{Any, Any}" href="#ChebyshevExpansions.averageKPM-Tuple{Any, Any}"><code>ChebyshevExpansions.averageKPM</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">`averageKPM(h::Hamiltonian, A; kBT = 0, Ef = 0, kw...)`</code></pre><p>Compute, using the Kernel Polynomial Method (KPM), the thermal expectation value <code>‚ü®A‚ü© = Œ£_k f(E_k) ‚ü®k|A|k‚ü© = ‚à´dE f(E) Tr [A Œ¥(E-H)]/N‚ÇÄ = Tr [A f(H)]/N‚ÇÄ</code> for a given hermitian operator <code>A</code> and a zero-dimensional hamiltonian <code>h</code> with a total of <code>N‚ÇÄ</code> orbitals (see <code>momentaKPM</code> and its options <code>kw</code> for further details). <code>f(E)</code> is the Fermi-Dirac distribution function, <code>|k‚ü©</code> are <code>h</code> eigenstates with energy <code>E_k</code>, kBT<code>is the temperature in energy units and</code>Ef` the Fermi energy.</p><pre><code class="nohighlight hljs">`averageKPM(Œº::MomentaKPM, A; kBT = 0, Ef = 0)``</code></pre><p>Same as above with the KPM momenta as input (see <code>momentaKPM</code>).</p><p><strong>See also</strong></p><pre><code class="nohighlight hljs">`dosKPM`, `momentaKPM`, `averageKPM`</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fernandopenaranda/ChebyshevExpansions.jl/blob/4645de963f6f0255a8f8eaa44375677da3664687/src/KPM.jl#L333-L349">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChebyshevExpansions.densityKPM-Tuple{Any, Any}" href="#ChebyshevExpansions.densityKPM-Tuple{Any, Any}"><code>ChebyshevExpansions.densityKPM</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">densityKPM(h::Hamiltonian, A; resolution = 2, kets = randomkets(1), kw...)</code></pre><p>Compute, using the Kernel Polynomial Method (KPM), the local density of states <code>œÅ‚Çñ(œµ) = ‚ü®k|Œ¥(œµ-h)|k‚ü©</code> for a single ket <code>|k‚ü©</code>, a collection of <code>{|k_i‚ü©}</code>, or a set of randomly- generated kets for a stochastic trace calculation(see <code>momentaKPM</code>).</p><p>The result is a tuple of energy points <code>œµ·µ¢::Vector</code> spanning the band  range, and real  <code>œÅ·¥¨‚Çñ(œµ·µ¢)::Vector</code> values. The number of energy points <code>œµ·µ¢</code> is <code>order *resolution</code>,  rounded to the closest integer.</p><p>If <code>kets</code> contains more than a single ket, the sum <code>‚àë‚ÇñœÅ‚Çñ(Œµ)</code> over all models will be computed. In the case of the default <code>kets = randomkets(h, I, n)</code>, this results in an estimate of the total density of states per orbital, computed through an stochastic trace,  <code>œÅ(œµ) = ‚àë‚Çñ‚ü®k|Œ¥(œµ-h)|k‚ü©/n ‚âà Tr[Œ¥(œµ-h)]/N‚ÇÄ</code>, where <code>N‚ÇÄ</code> is the total number of orbitals in the unit cell.</p><pre><code class="nohighlight hljs">`densityKPM(Œº::MomentaKPM; resolution = 2)`</code></pre><p>Same as above with KPM momenta <code>Œº</code> as input.</p><p><strong>See also</strong></p><pre><code class="nohighlight hljs">`dosKPM`, `momentaKPM`, `averageKPM`</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fernandopenaranda/ChebyshevExpansions.jl/blob/4645de963f6f0255a8f8eaa44375677da3664687/src/KPM.jl#L294-L317">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChebyshevExpansions.dosKPM-Tuple{Any}" href="#ChebyshevExpansions.dosKPM-Tuple{Any}"><code>ChebyshevExpansions.dosKPM</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dosKPM(h::Hamiltonian; resolution = 2, kets = randomkets(1), kw...)</code></pre><p>Compute, using the Kernel Polynomial Method (KPM), the local density of states <code>œÅ‚Çñ(œµ) = ‚ü®k|Œ¥(œµ-h)|k‚ü©</code> for a single ket <code>|k‚ü©</code>, a collection of <code>{|k_i‚ü©}</code>, or a set of randomly- generated kets for a stochastic trace calculation(see <code>momentaKPM</code>).</p><p>The result is a tuple of energy points <code>œµ·µ¢::Vector</code> spanning the band range, and real <code>œÅ‚Çñ(œµ·µ¢)::Vector</code> values (any residual imaginary part in <code>œÅ‚Çñ</code> is dropped). The number of energy points <code>œµ·µ¢</code> is <code>order * resolution</code>, rounded to the closest integer.</p><p>If <code>kets</code> contains more than a single ket, the sum <code>‚àë‚ÇñœÅ‚Çñ(Œµ)</code> over all models will be computed. In the case of the default <code>kets = randomkets(h, I, n)</code>, this results in an estimate of the total density of states per orbital, computed through an stochastic trace,  <code>œÅ(œµ) = ‚àë‚Çñ‚ü®k|Œ¥(œµ-h)|k‚ü©/n ‚âà Tr[Œ¥(œµ-h)]/N‚ÇÄ</code>, where <code>N‚ÇÄ</code> is the total number of orbitals in the unit cell.</p><p><code>dosKPM</code> is a particular case of <code>densityKPM</code> for an operator <code>A = I</code> and with any residual imaginary parts dropped</p><pre><code class="nohighlight hljs">`dosKPM(Œº::MomentaKPM; resolution = 2)`</code></pre><p>Same as above with KPM momenta <code>Œº</code> as input.</p><p><strong>See also</strong></p><pre><code class="nohighlight hljs">`momentaKPM`, `densityKPM`, `averageKPM`</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fernandopenaranda/ChebyshevExpansions.jl/blob/4645de963f6f0255a8f8eaa44375677da3664687/src/KPM.jl#L262-L288">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChebyshevExpansions.momentaKPM" href="#ChebyshevExpansions.momentaKPM"><code>ChebyshevExpansions.momentaKPM</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">`momentaKPM(h, A = I; kets = randomkets(h, A, n), order = 10, bandrange = missing)`</code></pre><p>Compute the Kernel Polynomial Method (KPM) momenta <code>Œº‚Çô = ‚ü®k|T‚Çô(h) A|k‚ü©</code>, where <code>|k‚ü©</code> may  either refer to a single ket (kets::AbstractVector), or a set of <code>kets::AbstractMatrix</code>  stored as columns, or to a collection of <code>n</code> random kets generated by <code>randomkets(h, A, n)</code>. <code>A</code> is an observable (<code>AbstractMatrix</code>) and <code>T‚Çô(h)</code> is the order-<code>n</code> Chebyshev polynomial of the Hamiltonian <code>h</code>.</p><p>For the randomkets case, <code>Œº‚Çô</code> is summed over all kets, <code>Œº‚Çô= ‚àë_k ‚ü®k|T‚Çô(h) A|k‚ü©</code>.  If <code>kets</code> are a multi-column ket, a sum over columns will similarly be performed. </p><p><code>kets</code> generated with <code>randomkets()</code> are useful to estimate momenta of normalized traces  using the stochastic trace approach, whereby <code>Œº_n = Tr[A T_n(h)]/N‚ÇÄ ‚âà ‚àë‚Çñ‚ü®k|A T_n(h)|k‚ü©</code>.  Here the <code>|k‚ü©</code>s are <code>n</code> random kets of norm <code>1/‚àön</code> and <code>N‚ÇÄ</code> is the total number of orbitals per unit cell of <code>h</code> (see <code>randomkets</code>).</p><p>The order of the Chebyshev expansion is <code>order</code>. The <code>bandbrange = (œµmin, œµmax)</code> should completely encompass the full bandwidth of <code>hamiltonian</code>. If <code>missing</code> it is computed automatically using <code>ArnoldiMethod</code> (must be loaded <code>using ArnoldiMethod</code>). </p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">julia&gt; momentaKPM(h, I, kets = randomkets(h, I, 5), order = 20)

julia&gt; momentaKPM(h, bandrange = (-6,6)).mulist |&gt; length
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fernandopenaranda/ChebyshevExpansions.jl/blob/4645de963f6f0255a8f8eaa44375677da3664687/src/KPM.jl#L66-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ChebyshevExpansions.randomkets-Tuple{Any, Any, Any}" href="#ChebyshevExpansions.randomkets-Tuple{Any, Any, Any}"><code>ChebyshevExpansions.randomkets</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">randomkets(h, A, n)</code></pre><p>Creates <code>n</code> random vectors with length <code>D = dim(h)</code> and stacks them into a <code>D√ón</code> matrix. The resulting ket amplitudes are normalized by <code>1/‚àön</code>.</p><p>This type of ket structure is useful e.g. in stochastic trace evaluation of KPM methods, where the amplitude, <code>a = cis(2pi*rand())</code> is chosen as a random function s.t. <code>‚ü®a‚ü© = 0</code>, <code>‚ü®aa‚ü© = 0</code> and <code>‚ü®a&#39;a‚ü© = 1</code>. Then, the normalized trace of an operator <code>A</code> can be estimated with <code>Tr[A]/N‚ÇÄ ‚âà ‚àë‚ü®ket|A|ket‚ü©</code>, where the sum is taken over the <code>n</code> random kets <code>|ket‚ü©</code> of norm <code>1/‚àön</code> produced by <code>randomkets</code>, and <code>N‚ÇÄ</code> is the total number of orbitals in the full unit cell.</p><p>By default when applied to a multiorbital system with a maximum of <code>N</code> orbitals per site,  the generated kets have independent, complex, normally-distributed random components </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fernandopenaranda/ChebyshevExpansions.jl/blob/4645de963f6f0255a8f8eaa44375677da3664687/src/KPM.jl#L4-L20">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Monday 21 February 2022 17:48">Monday 21 February 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
